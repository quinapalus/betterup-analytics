version: 2
models:
  - name: dei_reflection_point_metrics
    description: >
      This table contains information on RP completion metrics with member-track
      as the grain of the table (compared to reflection point being the grain in the
      `dei_reflection_points` table).

    columns:
      - name: member_id
        description: Denormalized foreign key to associated user.
        tests:
          - not_null

      - name: track_id
        description: Foreign key to associated track.
        tests:
          - not_null

      - name: organization_id
        description: Foreign key to associated organization.
        tests:
          - not_null

      - name: baseline_assessment_completed_at
        description: >
          Timestamp that denotes when the member completed the baseline onboarding
          assessment.
        tests:
          - not_null

      - name: earliest_met_prerequisites
        description: >
          Boolean denoting whether the member met prerequisites for the earliest
          RP assessment on the track.
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: earliest_met_prerequisites_at
        description: >
          Timestamp denoting when the member met prerequisites for the earliest
          RP assessment on the track.

      - name: earliest_eligible_at
        description: >
          Timestamp denoting when the member was scheduled to meet eligibility
          for the earliest RP for which they met prerequisites.

      - name: baseline_days_before_earliest_prerequisites
        description: >
          Number of days between the completed baseline assessment and the date
          the member met prerequisites for the earliest RP on track.

      - name: earliest_met_prerequisites_coach_id
        description: >
          Foreign key to associated coach for the earliest RP that the member
          was supposed to meet prerequisites.

      - name: earliest_met_prerequisites_session_count
        description: >
          Integer denoting how many sessions the member had completed on the track
          when they met the earliest prerequisites for an RP. NULL if earliest
          prerequisites haven't been met.

      - name: earliest_eligible_session_count
        description: >
          Integer denoting how many sessions the member had completed on the track
          when they became eligible for the earliest RP for which they met prerequisites.

      - name: latest_met_prerequisites
        description: >
          Boolean denoting whether the member met prerequisites for the latest
          RP assessment on the track.
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: latest_met_prerequisites_at
        description: >
          Timestamp denoting when the member met prerequisites for the latest
          RP assessment on the track.

      - name: latest_eligible_at
        description: >
          Timestamp denoting when the member was scheduled to meet eligibility
          for the earliest RP for which they met prerequisites.

      - name: baseline_days_before_latest_prerequisites
        description: >
          Number of days between the completed baseline assessment and the date
          the member met prerequisites for the latest RP on track.

      - name: latest_met_prerequisites_coach_id
        description: >
          Foreign key to associated coach for the latest RP that the member
          was supposed to meet prerequisites.

      - name: latest_met_prerequisites_session_count
        description: >
          Integer denoting how many sessions the member had completed on the track
          when they met the latest prerequisites for an RP. NULL if latest
          prerequisites haven't been met.

      - name: latest_eligible_session_count
        description: >
          Integer denoting how many sessions the member had completed on the track
          when they became eligible for the latest RP for which they met prerequisites.

      - name: earliest_coach_submitted
        description: >
          Boolean denoting whether the coach submitted the earliest
          RP assessment on the track.
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: earliest_coach_submitted_at
        description: >
          Timestamp denoting when the coach submitted the earliest
          RP assessment on the track.

      - name: baseline_days_before_earliest_coach
        description: >
          Number of days between the completed baseline assessment and the date
          the coach submitted the earliest RP assessment.

      - name: earliest_submitted_coach_id
        description: >
          Foreign key to associated coach with the earliest RP submission
          on track.

      - name: earliest_coach_submitted_session_count
        description: >
          Integer denoting how many sessions the member had completed on the track
          when the coach submitted the earliest RP. NULL if earliest RP
          hasn't been submitted by the coach.

      - name: latest_coach_submitted
        description: >
          Boolean denoting whether the coach submitted the latest
          RP assessment on the track.
        tests:
          - accepted_values:
              values: [true, false]

      - name: latest_coach_submitted_at
        description: >
          Timestamp denoting when the coach submitted the latest
          RP assessment on the track.

      - name: baseline_days_before_latest_coach
        description: >
          Number of days between the completed baseline assessment and the date
          the coach submitted the latest RP assessment.

      - name: latest_submitted_coach_id
        description: >
          Foreign key to associated coach with the latest RP submission
          on track.

      - name: latest_coach_submitted_session_count
        description: >
          Integer denoting how many sessions the member had completed on the track
          when the coach submitted the latest RP. NULL if latest RP
          hasn't been submitted by the coach.

      - name: earliest_member_submitted
        description: >
          Boolean denoting whether the member submitted the earliest
          RP assessment on the track.
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: earliest_member_submitted_at
        description: >
          Timestamp denoting when the member submitted the earliest
          RP assessment on the track.

      - name: baseline_days_before_earliest_member
        description: >
          Number of days between the completed baseline assessment and the date
          the member submitted the earliest RP assessment.

      - name: earliest_member_submitted_coach_id
        description: >
          Foreign key to associated coach with the earliest RP submission
          on track by the member.

      - name: earliest_member_submitted_session_count
        description: >
          Integer denoting how many sessions the member had completed on the track
          when they submitted the earliest RP. NULL if earliest RP
          hasn't been submitted by the member.

      - name: latest_member_submitted
        description: >
          Boolean denoting whether the member submitted the latest
          RP assessment on the track.
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: latest_member_submitted_at
        description: >
          Timestamp denoting when the member submitted the latest
          RP assessment on the track.

      - name: baseline_days_before_latest_member
        description: >
          Number of days between the completed baseline assessment and the date
          the member submitted the latest RP assessment.

      - name: latest_member_submitted_coach_id
        description: >
          Foreign key to associated coach with the latest RP submission
          on track by the member.

      - name: latest_member_submitted_session_count
        description: >
          Integer denoting how many sessions the member had completed on the track
          when they submitted the latest RP. NULL if latest RP
          hasn't been submitted by the member.

      - name: coach_submitted_count
        description: >
          Total number of completed RPs by coaches associated with the member-track
          pair.
        tests:
          - not_null

      - name: member_submitted_count
        description: >
          Total number of completed RPs by the member associated with the member-track
          pair.
        tests:
          - not_null

      - name: rp_canceled_count
        description: >
          Total number of canceled RPs associated with the member-track
          pair.
        tests:
          - not_null

      - name: reflection_point_interval_days
        description: >
          Number of days (from either when the member matched with a coach,
          when their last reflection point was completed, or when the last reflection point process
          was canceled) when the member will become eligible for the reflection point assessment.

      - name: reflection_point_interval_appointments
        description: >
          If set, this value triggers the reflection point process when the member
          meets the specified number of sessions, either since matching with a coach
          or completing their last reflection point.

      - name: deployment_type
        description: >
          External deployments only. Please see documentation for `dim_tracks` for more
          detail on deployment types.

