version: 2
models:
  - name: dei_sessions
    description: >
      This table contains information about session schedules and
      completions. Sessions listed in the table are associated with external
      deployments only (i.e. tracks listed in dim_tracks where is_external
      and engaged_member_count is not null).

    columns:
      - name: session_id
        description: Foreign key to associated session.
        tests:
          - unique
          - not_null

      - name: member_id
        description: Denormalized foreign key to associated member.
        tests:
          - not_null

      - name: coach_id
        description: Denormalized foreign key to associated coach.
        tests:
          - not_null

      - name: track_id
        description: Denormalized foreign key to associated track.
        tests:
          - not_null

      - name: scheduled_at
        description: >
          Timestamp of when the session was scheduled.
        tests:
          - not_null

      - name: requested_length
        description: >
          Requested length of the session in minutes.

      - name: recurring
        description: >
          Boolean specifying whether the session was requested as recurring
          or non-recurring.
        tests:
          - accepted_values:
              values: ['true', 'false']

      - name: starts_at
        description: >
          Timestamp of when the session was scheduled to start.

      - name: ends_at
        description: >
          Timestamp of when the session was scheduled to end.

      - name: canceled_at
        description: >
          Timestamp of when the session was canceled, if it was
          canceled. NULL if not canceled.

      - name: canceled
        description: >
          Boolean specifying if the session was canceled.
        tests:
          - accepted_values:
              values: ['true', 'false']

      - name: completed
        description: >
          Boolean specifying if the session was completed.
        tests:
          - accepted_values:
              values: ['true', 'false']

      - name: missed
        description: >
          Boolean specifying if the session was missed.
        tests:
          - accepted_values:
              values: ['true', 'false']

      - name: coach_assignment_id
        description: Foreign Key to associated coach assignment.
        tests:
          - not_null

      - name: track_assignment_id
        description: Foreign Key to associated track assignment.
        tests:
          - not_null

      - name: coach_type
        description: >
          String denoting the type of coaching provided during the session:
          primary, extended-network, or on-demand.

      - name: extended_network_session_type
        description: >
          String denoting the extended network vertical, if the session was
          conducted under the `secondary` category in `coach_type`. Will be
          NULL in the `dei` layer under the `primary` and `on_demand` categories.

      - name: call_id
        description: Foreign Key to associated calls.
        tests:
          - unique
          - not_null

      - name: development_topic_id
        description: >
          Foreign key to main topic discussed in the session, as coded by the coach in the
          post-session flow. Added as a required step on 7/17/2019 in
          [`betterup-app#10692`](https://github.com/betterup/betterup-app/pull/10692).
