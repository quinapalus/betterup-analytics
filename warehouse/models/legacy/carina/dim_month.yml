version: 2
models:
  - name: dim_month
    description: >
      Conformed shrunken Date dimension, includes one row for every month from February
      2015 up through five years from the current date.

    columns:
      - name: month_key
        description: Primary Key
        tests:
          - unique
          - not_null

      - name: calendar_year_month
        description: Concatenated Calendar year-month (YYYY-MM format).
        tests:
          - not_null

      - name: calendar_month_name
        description: >
          Mixed case calendar Month name for the given day, eg. `January`, `February`,
          etc.
        tests:
          - not_null

      - name: calendar_month_number
        description: >
          Two-digit calendar month number for the given day, eg. `01`, `02`, etc.
        tests:
          - not_null

      - name: calendar_year
        description: >
          Calendar year for the given day, eg. `2019`, `2020`, etc.
        tests:
          - not_null

      - name: fiscal_year
        description: >
          Fiscal year for the given month, note that our fiscal year starts on February
          1.
        tests:
          - not_null

      - name: fiscal_quarter
        description: Fiscal quarter for the given month.
        tests:
          - not_null
          - accepted_values:
              values: [Q1, Q2, Q3, Q4]

      - name: fiscal_year_quarter
        description: Concatenated Fiscal year-quarter for the given month.
        tests:
          - not_null

      - name: is_current_fiscal_quarter
        description: Boolean flag, true if month is within current fiscal quarter.
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: is_previous_fiscal_quarter
        description: Boolean flag, true if month is within previous fiscal quarter.
        tests:
          - not_null
          - accepted_values:
              values: [true, false]
