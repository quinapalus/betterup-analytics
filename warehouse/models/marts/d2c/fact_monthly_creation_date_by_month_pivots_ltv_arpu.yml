version: 2

models:
  - name: fact_monthly_creation_date_by_month_pivots_ltv_arpu
  
    meta:
      owner: "adrian.lievano@betterup.co"
    description: >
      A preaggregated, merged report to aide in the calculation of LTV 
      at the subscription created month date with monthly pivots by stripe plan id. 
      A record in this table contains data such as: stripe_plan_id, months_from_creation_date, 
      subscription_created_month, forecasted_ltv_contribution. To obtain total forecasted LTV,
      the aggregation occurs in Looker as an additive measure on the forecasted LTV contribution column.
    columns:
      - name: _id
        description: Primary key
        tests:
          - unique
          - not_null

      - name: stripe_plan_id
        description: >
          Foreign key reference to dim_plans (also known as stripe plans)

      - name: subscription_created_month
        description: >
          The creation date of the subscription truncated to the month.
        

      - name: pivot_reporting_month
        description: >
          The count of months that a subscription is counted as active minus the starting month of the
          subscription creation date. 

      - name: is_complete_reporting_pivot
        description: >
          Cohort analysis typically have periods that are updating and periods that are complete. 
          If a record in this table is still being updated, which means the time period in question 
          is still receiving data because the month is not complete, this flag will be false. 
          If the values are set and no longer changing, it is true.

      - name: monthly_amount
        description: >
          This is a dimension from stripe plans. It is the estimated monthly amount
          charged by each plan_id. For annual or semi-annual plans, it is the normalized
          monthly amount, which is calculated by dividing the total plan billed amount by the 
          number of billing months.

      - name: total_retained
        description: >
          Total number of unique members with an active subscription after X
          months from the month of their subscription creation date. 

      - name: total_cohort_size
        description: >
          Total number of unique members that created a subscription in a month.

      - name: retention_rate
        description: >
          The total number of retained members X months away 
          from the date the member created a subscription divided 
          by the total number of unique members that create a subscription in
          the month.

      - name: forecasted_ltv_contribution
        description: >
          The total dollar amount that a group of subscriptions created 
          in a month relative to the number of days away from the creation date is
          forecasted to generate in that period.