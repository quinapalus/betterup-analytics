#!/usr/bin/env python
"""Minimalistic CI/CD utility command for setting value in YAML file"""
import click
import yaml


@click.command()
@click.argument("file_path", type=click.Path(exists=True, dir_okay=False))
@click.argument("key_path", type=str)
@click.argument("value", type=str)
def main(file_path, key_path, value):
    """Set a value in a YAML file
    
    FILE_PATH is the Path to YAML file
    KEY_PATH is a dot separated path to value
    VALUE is the value to set
    """
    with open(file_path) as file:
        data = yaml.safe_load(file)

    nested_set(data, key_path.split("."), value)
    
    with open(file_path, "w") as file:
        yaml.safe_dump(data, file)


def nested_set(dic, keys, value):
    for key in keys[:-1]:
        dic = dic.setdefault(key, {})
    dic[keys[-1]] = value


if __name__ == "__main__":
    main() # pylint: disable=no-value-for-parameter
